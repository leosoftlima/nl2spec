The system behavior is defined in terms of explicit states and transitions.

The monitored events are:

1) Event name: sort1
   Kind: event
   Timing: before
   Parameters: Object[] arr
   Pointcut: call(void Arrays.sort(Object[])) && args(arr)

2) Event name: sort1
   Kind: event
   Timing: before
   Parameters: Object[] arr, int from, int to
   Pointcut: call(void Arrays.sort(Object[], int, int)) && args(arr, from, to)

3) Event name: sort2
   Kind: event
   Timing: before
   Parameters: Object[] arr, Comparator comp2
   Pointcut: call(void Arrays.sort(Object[], Comparator)) && args(arr, comp2)

4) Event name: sort2
   Kind: event
   Timing: before
   Parameters: Object[] arr, int from, int to, Comparator comp2
   Pointcut: call(void Arrays.sort(Object[], int, int, Comparator)) && args(arr, from, to, comp2)

5) Event name: modify
   Kind: event
   Timing: before
   Parameters: Object[] arr
   Pointcut: set(Object[] *) && args(arr)

6) Event name: bsearch1
   Kind: event
   Timing: before
   Parameters: Object[] arr
   Pointcut: call(int Arrays.binarySearch(Object[], Object)) && args(arr, ..) && condition(this.fromIndex <= 0 && arr.length <= this.toIndex)

7) Event name: bsearch1
   Kind: event
   Timing: before
   Parameters: Object[] arr, int from, int to
   Pointcut: call(int Arrays.binarySearch(Object[], int, int, Object)) && args(arr, from, to, ..) && condition(this.fromIndex <= from && to <= this.toIndex)

8) Event name: bsearch2
   Kind: event
   Timing: before
   Parameters: Object[] arr, Comparator comp2
   Pointcut: call(int Arrays.binarySearch(Object[], Object, Comparator)) && args(arr, .., comp2) && condition(this.fromIndex <= 0 && arr.length <= this.toIndex && this.comp == comp2)

9) Event name: bsearch2
   Kind: event
   Timing: before
   Parameters: Object[] arr, int from, int to, Comparator comp2
   Pointcut: call(int Arrays.binarySearch(Object[], int, int, Object, Comparator)) && args(arr, from, to, .., comp2) && condition(this.fromIndex <= from && to <= this.toIndex && this.comp == comp2)

The finite state behavior is defined as follows:

		unsorted [
			sort1 -> sorted1
			sort2 -> sorted2
			modify -> unsorted
		]
		sorted1 [
			sort1 -> sorted1
			sort2 -> sorted2
			modify -> unsorted
			bsearch1 -> sorted1
		]
		sorted2 [
			sort1 -> sorted1
			sort2 -> sorted2
			modify -> unsorted
			bsearch2 -> sorted2
		]

Any execution that deviates from the state transition behavior described above constitutes a violation.

The violation message that must be used in the JSON output is:

"The array or part of the array must be sorted prior to making binarySearch() call."
