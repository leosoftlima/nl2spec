The following events are involved in this specification:

1) Event name: createMap
   Kind: creation
   Timing: after
   Parameters: none
   Returning: Map map
   Pointcut: call(Map System.getenv())

2) Event name: nullPut
   Kind: event
   Timing: before
   Parameters: Map map, Object key, Object value
   Pointcut: call(* Map.put(..)) && args(key, value) && target(map) && condition(key == null || value == null)

3) Event name: nullPut
   Kind: event
   Timing: before
   Parameters: Map map, Map map2
   Pointcut: call(* Map.putAll(Map)) && args(map2) && target(map) && condition(map2.containsKey(null) || map2.containsValue(null))

4) Event name: nullQuery
   Kind: event
   Timing: before
   Parameters: Map map, Object o
   Pointcut: (call(* Map.containsKey(..)) || call(* Map.containsValue(..)) || call(* Map.get(..)) || call(* Map.remove(..))) && target(map) && args(o) && condition(o == null)

5) Event name: notStringQuery
   Kind: event
   Timing: before
   Parameters: Map map, Object o
   Pointcut: (call(* Map.containsKey(..)) || call(* Map.containsValue(..)) || call(* Map.get(..)) || call(* Map.remove(..))) && target(map) && args(o) && condition(!(o instanceof String))

The required execution pattern is defined by the following regular expression:

createMap (nullPut | nullQuery | notStringQuery)+

Any execution trace that does not conform to this pattern constitutes a violation.

The violation message that must be used in the JSON output is:

"null key or value is not permitted in the map from System.getenv(). Also key or value which is not of type String is not allowed."
