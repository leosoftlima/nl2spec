The following events are involved in this specification:

1) Event name: create_connected
   Kind: creation
   Timing: after
   Parameters: none
   Returning: Socket sock
   Pointcut: ( call(Socket.new(InetAddress, int)) || call(Socket.new(InetAddress, int, boolean)) || call(Socket.new(InetAddress, int, InetAddress, int)) || call(Socket.new(String, int)) || call(Socket.new(String, int, boolean)) || call(Socket.new(String, int, InetAddress, int)) )

2) Event name: create_unconnected
   Kind: creation
   Timing: after
   Parameters: none
   Returning: Socket sock
   Pointcut: ( call(Socket.new()) || call(Socket.new(Proxy)) || call(Socket.new(SocketImpl)) )

3) Event name: connect
   Kind: event
   Timing: before
   Parameters: Socket sock
   Pointcut: call(* Socket+.connect(..)) && target(sock)

4) Event name: set
   Kind: event
   Timing: before
   Parameters: Socket sock, int size
   Pointcut: call(* Socket+.setReceiveBufferSize(int)) && target(sock) && args(size) && condition(size > 65536)

The required execution pattern is defined by the following regular expression:

(create_connected | create_unconnected set* connect+) set

Any execution trace that does not conform to this pattern constitutes a violation.

The violation message that must be used in the JSON output is:

"A receive window large than 64K bytes must be set before the socket is connected."
