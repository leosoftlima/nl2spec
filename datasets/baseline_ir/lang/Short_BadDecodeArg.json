{
  "id": "Short_BadDecodeArg",
  "formalism": "event",
  "domain": "lang",
  "signature": {
    "name": "Short_BadDecodeArg",
    "parameters": []
  },
  "ir": {
    "type": "event",
    "events": [
      {
        "kind": "event",
        "name": "decode",
        "timing": "before",
        "parameters": [
          {
            "type": "Short",
            "name": "s"
          },
          {
            "type": "String",
            "name": "nm"
          }
        ],
        "pointcut_raw": "call(* Short.decode(String)) && args(nm) && target(s)",
        "body": {
          "raw_lines": [
            "        if(nm == null || nm.length() == 0){",
            "            RVMLogging.out.println(Level.CRITICAL, __DEFAULT_MESSAGE);",
            "            RVMLogging.out.println(Level.CRITICAL, \"Wrong argument to Short.decode(String nm)\");",
            "        } else {",
            "            //whitespace check",
            "            for(int j = 0; j < nm.length(); j++){",
            "                if(Character.isWhitespace(nm.charAt(j))){",
            "                    RVMLogging.out.println(Level.CRITICAL, __DEFAULT_MESSAGE);",
            "                    RVMLogging.out.println(Level.CRITICAL, \"Wrong argument to Short.decode(String nm)\");",
            "                }",
            "            }",
            "            //formatcheck",
            "            String sub;",
            "            if(nm.charAt(0) == '-'){",
            "                sub = nm.substring(1);",
            "            } else {",
            "                sub = nm;",
            "            }",
            "            int radix = 0;",
            "            if(sub.startsWith(\"0x\") || sub.startsWith(\"0X\")){",
            "                sub = sub.substring(2);",
            "                radix = 16;",
            "            } else if(sub.startsWith(\"#\")){",
            "                sub = sub.substring(1);",
            "                radix = 16;",
            "            } else if(sub.startsWith(\"0\")){",
            "                sub = sub.substring(1);",
            "                radix = 8;",
            "            } else {",
            "                radix = 10;",
            "            }",
            "            try{",
            "                if(Short.parseShort(sub, radix) < 0){",
            "                    RVMLogging.out.println(Level.CRITICAL, __DEFAULT_MESSAGE);",
            "                    RVMLogging.out.println(Level.CRITICAL, \"Wrong argument to Short.decode(String nm)\");",
            "                }",
            "            } catch(Exception e){",
            "                RVMLogging.out.println(Level.CRITICAL, __DEFAULT_MESSAGE);",
            "                RVMLogging.out.println(Level.CRITICAL, \"Wrong argument to Short.decode(String nm)\");",
            "            }",
            "        }"
          ]
        }
      }
    ],
    "violation": {
      "tag": null,
      "raw_block": []
    }
  }
}