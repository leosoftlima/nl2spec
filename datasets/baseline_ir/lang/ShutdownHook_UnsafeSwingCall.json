{
  "id": "ShutdownHook_UnsafeSwingCall",
  "formalism": "fsm",
  "domain": "lang",
  "signature": {
    "name": "ShutdownHook_UnsafeSwingCall",
    "parameters": [
      {
        "type": "Thread",
        "name": "t"
      }
    ]
  },
  "ir": {
    "type": "fsm",
    "events": [
      {
        "kind": "creation",
        "name": "register",
        "timing": "before",
        "parameters": [
          {
            "type": "Thread",
            "name": "t"
          }
        ],
        "pointcut_raw": "call(* Runtime+.addShutdownHook(..)) && args(t)",
        "body": {
          "raw_lines": []
        }
      },
      {
        "kind": "creation",
        "name": "unregister",
        "timing": "before",
        "parameters": [
          {
            "type": "Thread",
            "name": "t"
          }
        ],
        "pointcut_raw": "call(* Runtime+.removeShutdownHook(..)) && args(t)",
        "body": {
          "raw_lines": []
        }
      },
      {
        "kind": "event",
        "name": "start",
        "timing": "before",
        "parameters": [
          {
            "type": "Thread",
            "name": "t"
          }
        ],
        "pointcut_raw": "startThread() && thread(t)",
        "body": {
          "raw_lines": []
        }
      }
    ],
    "fsm": {
      "raw_block": "\t\tunregistered [\n\t\t\tregister -> registered\n\t\t]\n\t\tregistered [\n\t\t\tunregister -> unregistered\n\t\t\tstart -> started\n\t\t]\n\t\tstarted [\n\t\t\tswingcall1 -> unsafe\n\t\t\tswingcall2 -> unsafe\n\t\t]\n\t\tunsafe [\n\t\t\tswingcall1 -> unsafe\n\t\t\tswingcall2 -> unsafe\n\t\t]\n\t@unsafe {\n\t\tRVMLogging.out.println(Level.CRITICAL, __DEFAULT_MESSAGE);\n\t\tRVMLogging.out.println(Level.CRITICAL, \"An operation that potentially leads to deadlocks was performed in a shutdown hook.\");",
      "raw_lines": [
        "\t\tunregistered [",
        "\t\t\tregister -> registered",
        "\t\t]",
        "\t\tregistered [",
        "\t\t\tunregister -> unregistered",
        "\t\t\tstart -> started",
        "\t\t]",
        "\t\tstarted [",
        "\t\t\tswingcall1 -> unsafe",
        "\t\t\tswingcall2 -> unsafe",
        "\t\t]",
        "\t\tunsafe [",
        "\t\t\tswingcall1 -> unsafe",
        "\t\t\tswingcall2 -> unsafe",
        "\t\t]",
        "\t@unsafe {",
        "\t\tRVMLogging.out.println(Level.CRITICAL, __DEFAULT_MESSAGE);",
        "\t\tRVMLogging.out.println(Level.CRITICAL, \"An operation that potentially leads to deadlocks was performed in a shutdown hook.\");"
      ]
    },
    "analysis": {
      "states": [
        "registered",
        "started",
        "unregistered",
        "unsafe"
      ],
      "initial": "unregistered",
      "transitions": [
        {
          "from": "unregistered",
          "event": "register",
          "to": "registered"
        },
        {
          "from": "registered",
          "event": "unregister",
          "to": "unregistered"
        },
        {
          "from": "registered",
          "event": "start",
          "to": "started"
        },
        {
          "from": "started",
          "event": "swingcall1",
          "to": "unsafe"
        },
        {
          "from": "started",
          "event": "swingcall2",
          "to": "unsafe"
        },
        {
          "from": "unsafe",
          "event": "swingcall1",
          "to": "unsafe"
        },
        {
          "from": "unsafe",
          "event": "swingcall2",
          "to": "unsafe"
        }
      ]
    },
    "violation": {
      "tag": null,
      "raw_block": []
    }
  }
}