You are an expert system for Runtime Verification.

Your task is to transform natural language descriptions of correct or incorrect
API usage into a formal Intermediate Representation (IR) expressed in JSON.

The generated IR will be used to build executable runtime monitors.
Precision, consistency, and executability are mandatory.

The output must be a single valid JSON object and nothing else.
Do not include explanations, comments, or natural language text outside the JSON.


Context:
The IR represents an event-based runtime monitor.

Event-based semantics:
- The specification defines constraints over events.
- Events correspond to method calls or returns.
- Violations occur when an event happens in an invalid context.
- The monitor does not maintain explicit states.

Event-based IR structure:
- "type" must be "event"
- "events": list of monitored events
- "constraints": list of event constraints
- "violation_message": message emitted when a constraint is violated

Constraints:
- Do not invent events or methods not implied by the description.
- Keep constraints minimal and precise.
- Do not introduce states or temporal automata.
- Follow exactly the structure shown in the examples.

Examples:
Example 1:
{
  "id": "event_05",
  "category": "EVENT",
  "domain": "net",
  "natural_language": "Warn if data is sent through a socket before it is connected.",
  "ir": {
    "type": "event",
    "events": [
      {
        "name": "send",
        "timing": "before"
      }
    ],
    "guard": "!connected",
    "violation_message": "Data sent through socket before connection."
  }
}

Example 2:
{
  "id": "event_03",
  "category": "EVENT",
  "domain": "net",
  "natural_language": "Warn if an encoder produces output using a non-UTF-8 charset.",
  "ir": {
    "type": "event",
    "events": [
      {
        "name": "encode",
        "timing": "after"
      }
    ],
    "guard": "charset != 'UTF-8'",
    "violation_message": "Non-UTF-8 encoding used."
  }
}


Task:
Generate a EVENT runtime verification IR in JSON format
that captures the behavior described below.

Natural language description:
"""
;
	}

	event staticinit after() : staticinitialization(Serializable+) {
		org.aspectj.lang.Signature initsig = __STATICSIG;
		Class klass = initsig.getDeclaringType();		

		if (klass != null) {
			Class nonserialzable = klass;
			while (Serializable.class.isAssignableFrom(nonserialzable)) {
				nonserialzable = nonserialzable.getSuperclass();
				if (nonserialzable == null)
					break;
			}

			if (nonserialzable != null) {
				boolean samepackage = klass.getClassLoader() == nonserialzable.getClassLoader() &&
					getPackageName(klass).equals(getPackageName(nonserialzable));

				boolean inaccessible = true;
				try {
					Constructor ctor = nonserialzable.getDeclaredConstructor((Class[]) null);
					int mod = ctor.getModifiers();
					inaccessible = (mod & Modifier.PRIVATE) != 0 ||
						((mod & (Modifier.PUBLIC | Modifier.PROTECTED)) == 0 && !samepackage);
				}
				catch (NoSuchMethodException e) {
				}
				if (inaccessible) {
					RVMLogging.out.println(Level.CRITICAL, __DEFAULT_MESSAGE);
					RVMLogging.out.println(Level.CRITICAL,
"""